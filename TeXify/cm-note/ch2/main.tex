\chapter{Manipulating sums}

\section{Basic Notations}

\mkpt{Summation notation} We can use $\sum$ to denote add things together.
\begin{itemize}
    \item $\sum_{a}$: sum over all items in $a$
    \item $\sum_{i=1}^{n} f(i)$: sum from $i=1$ to $i=n$, substituting all $i$s
        in the right $f(i)$.
\end{itemize} 

\mkpt{Iverson's Bracket} We have the notation $[p]$: $p$ is a proposition, and
when $p$ is true, the equation is evaluated 1, otherwise evaluated as 0. 

\mkpt{Using Aversion's bracket to simplifying sums} For example we have 
\[
    \sum_{p\text{ prime},p \leq N} p = \sum_p [p\text{ prime}][p \leq N] p.
\]

\section{Manipulation of sums}

\mkpt{Distributive law} $\sum_{k\in K} ca_k=c\sum_{k\in K}a_k$.

\mkpt{Associative law} $\sum_{k\in K} (a_k+b_k)=\sum_{k\in K}a_k+\sum_{k\in K}b_k$.

\mkpt{Commutative law} $\sum_{k\in K} a_k=\sum_{p(k)\in K}a_{p(k)}$. 

This rule is for mainly substitution use. When the condition is not specified, the
$p(k)$ should be a permutation of all integers. 

Example. We have 
\[
    \sum_{k\in K, k \texttt{ even}}^{} a_k = \sum_{n\in K, n \texttt{ even}}^{}a_n
    =\sum_{2k \in k}^{a_{2k}}
\]


\mkpt{Example 1: Arithmetic's progression} We have $S=\sum_{0\leq k\leq
n}(a+bk)$. By commutative law, replace $k$ by $n-k$, obtaining $S=\sum_{0\leq
n-k\leq n}(a+b(n-k))=\sum_{0\leq k \leq n} (a+bn-bk)$. These two can be added
up to $2S=\sum_{0 \leq k\leq n} (2a+bn)$. Then this problem would be trivial. 

\mkpt{Exclusion and Inclusive Principle with Sums} Here is a important rule for combining
different set of indicies. 

Suppose $K$ and $K'$ are any set of integers, then 
\[
    \sum_{k \in K}^{}a_k + \sum_{k\in K'}^{}a_k = \sum_{k\in k \cap K'}^{}a_k +
    \sum_{K\in K \cup K'}^{}a_k.
\]
In the case of Iverson's bracket, we have 
\[
    [k\in K]+[k\in K'] = [k \in K \cap K'] + [K \in K \cup K']
\]
\mkpt{Perturbation method} We first write $S_n = \sum_{0 \leq k \leq n}^{}a_k$,
then we rewrite $S_{n+1}$ in 2 ways: 
\begin{align*}
    S_n +a_{n+1} &= \sum_{0 \leq k \leq n+1}^{} &= a_0 + \sum_{1\leq k\leq n+1}^{}a_k  \\
                 & &= a_0 + \sum_{1\leq k+1 \leq n+1}^{}a_{k+1}\\
                 & &= a_0 + \sum_{0 \leq k \leq n}^{}a_{k+1}.
\end{align*}

Now we can work on the last term trying to solving the closed form for it. 

\mkpt{Example 2. Geometry progression} We have $S_n = \sum_{0 \leq k \leq
n}^{}ax^k$. And the sum is needed. Using {\it perturbation} method we have 
\[
    S_n + ax^{n+1} = ax^0 + \sum_{0\leq k\leq n}^{}ax^{k+1}
\]

Factoring out an $x$, we have
\begin{align*}
    S_n + ax^{n+1} &= a + xS_n \\
    \sum_{k=0}^{n} ax^k = \frac{a-ax^{n+1}}{1-x}, \qquad \text{for } x \neq 1
\end{align*}

\mkpt{Example 3. Arithmetic Geometric progression} We have the sequence 
\[
    S_n = \sum_{0 \leq k \leq n}^{}k 2^k
\]

Using the perturbation technique, we have 
\[
    S_n + (n+1)^{2n+1} = \sum_{0\leq k\leq n}^{}(k+1)2^{k+1}
\]
Rewrite RHS as sums, we have 
\[
    S_n + (n+1)^{2n+1} = \sum_{0\leq k\leq n}^{}k 2^{k+1} + 
    \sum_{0\leq k\leq n}^{}2^{k+1}
\]
Hence $\sum_{0\leq k\leq n}^{}k 2^k = (n-1)2^{n+1}+2$.

\section{Multiple sums}

\mkpt{Notations} Stacking multiple sums in a row helps to derivate more
complex sums. 

Example: $\sum_{i=1}^{3}\sum_{j=1}^{3}a_{ij} = a_{11}+a_{12}+a_{13}+\cdots
+a_{33}$.

Using the simplified Iverson's bracket, getting another way of expressing
multiple sums: $\sum_{1\leq j,k\leq 3}^{}a_j b_k = \sum_{j,k}^{}a_jb_k[1\leq
j\leq 3] [1\leq k\leq 3]$. 

\mkpt{General distributive law} For distinct lower set index $i,j$, we have the
following distributive law: 
\[
    \sum_{j\in J,k\in K}^{}a_jb_k = \big( \sum_{j\in J}^{}a_j \big) + \big(
    \sum_{k\in K}^{}b_k \big)
\]
Another general form for this is $\sum_{j\in J}^{}\sum_{k\in
K(j)}^{}a_{j,k}=\sum_{k \in K'}^{} \sum_{j\in J'(k)}^{}a_{j, k}$. Here, the sets
should satisfy $[j \in J][k \in K(j)] = [k \in K'][j \in J'(k)]. $

\mkpt{Example 1. Consecutive integers} We may rewrite $[1\leq j\leq n][j\leq
k\leq n] = [1\leq j\leq k\leq n] = [1\leq k\leq n][1\leq j\leq k]$. 

\mkpt{Example 2. Sum over an matrix} 
We try to find a simplified idea of the matrix
\[
    \left(\begin{matrix}
            a_1a_1& a_1a_2 & \cdots & a_1a_n \\
            a_2a_1&a_2a_2&\cdots & a_2a_n\\
            \vdots & \vdots & \ddots & \vdots \\
            a_na_1 & a_na_2&\cdots & a_na_n
    \end{matrix}\right)
\]
we shall find a sum $S_1 = \sum_{1\leq j\leq k\leq n}^{}a_ja_k$. 

According to the associativity of the multiplication, we find that $a_j a_k= a_k
a_j$. Hence we have $S_\Delta = \sum_{1\leq j\leq k\leq n}^{}a_ja_k =
\sum_{1\leq k\leq j\leq n}^{}a_ka_j=\sum_{1\leq j\leq n}^{}a_ja_k=S_\nabla$.
According to the problem above, we have $[1\leq j\leq k\leq n]+[1\leq k\leq
j\leq n]=[1\leq j,k\leq n]+[1\leq j=k\leq n]$. We have 
\[
    2S_\nabla = S_\nabla + S_\Delta = \sum_{1\leq j,k\leq n}^{}a_ja_k + 
    \sum_{1\leq j=k\leq n}^{} a_j a_k. 
\]

The first sum is $\left( \sum_{j=1}^{n}a_j \right) \left( \sum_{k-1}^{n} a_k \right) = \left( \sum_{k=1}^{n}a_k  \right)^2$, and the second sum is that $\sum_{k-1}^{n}a_k^2$. 

So we have the sum 
\[
    \sum_{\nabla}^{} = \sum_{1\leq j\leq k\leq n}^{}a_ja_k = \frac{1}{2} \left(
    \left( \sum_{k=1}^{n} a_k \right)^2 + \sum_{k=1}^{n}a_k^2\right).
\]

The idea is like the aligning the data and subtracting the overlapped off.
That's a more religious form. 

\mkpt{Another double sum} We try to evaluate 
\[
    S=\sum_{1\leq j< k\leq n}^{} (a_k-a_j)(b_k-b_j).
\]

According we have 
